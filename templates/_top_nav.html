{# templates/_top_nav.html #}
<nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom sticky-top">
  <div class="container-fluid">
    <a class="navbar-brand d-flex align-items-center" href="{{ url_for('home') }}">
      {% if current_team and current_team.logo_path %}
          <img src="{{ url_for('static', filename='uploads/logos/' + current_team.logo_path) }}" alt="{{ current_team.team_name }} Logo" style="height: 40px; margin-right: 10px;">
      {% endif %}
      <span class="fw-bold brand-text">
        {% if current_team %}
            {{ current_team.team_name }}
        {% else %}
            Coach Planner
        {% endif %}
      </span>
    </a>
    
    <div class="d-lg-none ms-auto">
        <a class="nav-link" href="#" id="mobile-more-button"><i class="bi bi-three-dots" style="font-size: 1.8rem;"></i></a>
    </div>

    <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0 desktop-nav" id="mainTabsDesktop" role="tablist">
            {% for tab_key in tab_order %}
                {% if tab_key in ['roster', 'player_development', 'games', 'practice_plan', 'lineups'] %}
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#{{ tab_key }}" role="tab">
                        <i class="bi bi-grip-vertical me-1 drag-handle" title="Drag to reorder"></i>
                        {{ all_tabs[tab_key] }}
                    </a>
                </li>
                {% endif %}
            {% endfor %}
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="moreTabsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    More
                </a>
                <ul class="dropdown-menu" aria-labelledby="moreTabsDropdown">
                    {% for tab_key in tab_order %}
                        {% if tab_key not in ['roster', 'player_development', 'games', 'practice_plan', 'lineups'] %}
                        <li>
                            <a class="dropdown-item" data-bs-toggle="tab" href="#{{ tab_key }}" role="tab">{{ all_tabs[tab_key] }}</a>
                        </li>
                        {% endif %}
                    {% endfor %}
                </ul>
            </li>
        </ul>
        <ul class="navbar-nav desktop-nav">
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="userMenuDesktop" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    Welcome, {{ session.username }}!
                </a>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenuDesktop">
                    {% if session.role in ['Head Coach', 'Super Admin'] %}
                    <li><a class="dropdown-item" href="{{ url_for('user_management') }}">User Management</a></li>
                    <li><a class="dropdown-item" href="{{ url_for('admin_settings') }}">Admin Settings</a></li>
                    <li><hr class="dropdown-divider"></li>
                    {% endif %}
                    <li><a class="dropdown-item" href="{{ url_for('change_password') }}">Change Password</a></li>
                    <li><a class="dropdown-item" href="{{ url_for('logout') }}">Logout</a></li>
                </ul>
            </li>
        </ul>
    </div>
  </div>
</nav>